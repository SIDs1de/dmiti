from typing import Self
from src.rational import Rational


class MUL_PQ_P:
    def MUL_PQ_P(self: Self, second: Rational) -> Self:
        """
        Приготовил: Permitin Viktor
        Умножение многочлена на рациональное число
        
        Параметры:
            self: Self - многочлен (уменьшаемое)
            second: Rational - рациональное число (множитель)
        
        Возвращает:
            Self - результат умножения многочлена на рациональное число
        
        Алгоритм:
            Умножает каждый коэффициент многочлена на заданное рациональное число.
            
            1. Создаем копию исходного многочлена
            2. Для каждого коэффициента многочлена:
               - Умножаем коэффициент на рациональное число second
               - Заменяем старый коэффициент на результат умножения
            3. Возвращаем новый многочлен с обновленными коэффициентами
        
        Математически:
            Если P(x) = a_n*x^n + a_(n-1)*x^(n-1) + ... + a_1*x + a_0
            и r - рациональное число, то:
            P(x) * r = (a_n*r)*x^n + (a_(n-1)*r)*x^(n-1) + ... + (a_1*r)*x + (a_0*r)
        
        Примеры:
            MUL_PQ_P({2: 3/4, 1: 1/2, 0: 1}, 2) = {2: 3/2, 1: 1, 0: 2}
            MUL_PQ_P({1: 5, 0: 3}, 1/2) = {1: 5/2, 0: 3/2}
            MUL_PQ_P({0: 7}, 0) = {0: 0}  (умножение на ноль)
        
        Используется в:
            - SUB_PP_P (вычитание многочленов через умножение на -1)
            - MUL_PP_P (умножение многочленов)
            - DIV_PP_P (деление многочленов)
            - FAC_P_Q (вынесение общего множителя)
        
        Примечание:
            Метод не изменяет исходный многочлен, а возвращает новый.
            Все коэффициенты умножаются на одно и то же рациональное число,
            что соответствует умножению многочлена на скаляр.
        """
        # Создаем копию исходного многочлена для сохранения его неизменности
        result = self.copy()

        # Проходим по всем коэффициентам многочлена
        # coefficients - словарь, где ключ - степень, значение - коэффициент (Rational)
        for index, coefficient in self.coefficients.items():
            # Умножаем каждый коэффициент на рациональное число second
            # MUL_QQ_Q выполняет умножение двух рациональных чисел
            result.coefficients[index] = coefficient.MUL_QQ_Q(second)

        # Возвращаем многочлен с обновленными коэффициентами
        return result
